

<!DOCTYPE html>
<html class="writer-html5" lang="tr" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Sanal ortam yaratarak çalışın &mdash; TRUBA Belgeler  belgelendirmesi</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Dizin" href="../../genindex.html" />
    <link rel="search" title="Ara" href="../../search.html" />
    <link rel="next" title="Container imajları ile çalışın" href="container.html" />
    <link rel="prev" title="Derin öğrenme modelleri gelişitirin" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> TRUBA Belgeler
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">GPU kaynaklarını kullanın</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Derin öğrenme modelleri gelişitirin</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Sanal ortam yaratarak çalışın</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ev-dizininize-anaconda-kurun">Ev dizininize Anaconda kurun</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sbatch-kullanarak-kuyruga-is-gonderin">sbatch kullanarak kuyruğa iş gönderin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="container.html">Container imajları ile çalışın</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TRUBA Belgeler</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">GPU kaynaklarını kullanın</a> &raquo;</li>
        
          <li><a href="index.html">Derin öğrenme modelleri gelişitirin</a> &raquo;</li>
        
      <li>Sanal ortam yaratarak çalışın</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/GPU/deep-learning/virtual-env.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sanal-ortam-yaratarak-calisin">
<h1>Sanal ortam yaratarak çalışın<a class="headerlink" href="#sanal-ortam-yaratarak-calisin" title="Bu başlık için kalıcı bağlantı">¶</a></h1>
<p>TRUBA altyapısında Anaconda kullanarak yarattığınız sanal ortama CUDA yükleyebilirsiniz.</p>
<div class="admonition note">
<p class="admonition-title">Not</p>
<p>Sanal ortam kullanarak belirli bir Python sürümü için bir Python kurulumu ve bir dizi ek paket içeren bağımsız bir dizin ağacı yaratabilirsiniz. Bu sayede farklı uygulamalarınız için farklı sanal ortamlar yaratarak çakışan gereksinimlerin oluşmasını önlersiniz.</p>
</div>
<p>Başlamadan önce:</p>
<ul class="simple">
<li><p>Anaconda <a class="reference external" href="https://docs.conda.io/projects/continuumio-conda/en/latest/user-guide/install/linux.html">kurulum dökümanına</a> göz atın.</p></li>
<li><p>NVIDIA GPU ile çalışmak için <a class="reference external" href="https://www.tensorflow.org/install/source#gpu">uyumlu Python, Tensorflow, CUDA ve cuDNN versiyonlarını</a> öğrenin.</p></li>
<li><p>sbatch ile <a class="reference external" href="https://slurm.schedmd.com/sbatch.html">kuyruğa iş gönderme dökümanına</a> bakın.</p></li>
</ul>
<div class="section" id="ev-dizininize-anaconda-kurun">
<h2>Ev dizininize Anaconda kurun<a class="headerlink" href="#ev-dizininize-anaconda-kurun" title="Bu başlık için kalıcı bağlantı">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Not</p>
<p>Miniconda, Anaconda’nın yalnızca conda, Python, bağlı oldukları paketleri ve pip, zlib ve diğer birkaçını da içeren az sayıda başka yararlı paketi içeren küçük, önyükleme sürümüdür.</p>
</div>
<p>Miniconda indirin:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash Miniconda3-latest-Linux-x86_64.sh
</pre></div>
</div>
<p>Kurulum yaparken:</p>
<ul class="simple">
<li><p>/truba/home/… ile başlayan kurulum lokasyonunu değiştirmeyin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">init</span></code> komutunu çalıştırmayın.</p></li>
</ul>
<p>Bittikten sonra script’i silebilirsiniz:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm Miniconda3-latest-Linux-x86_64.sh
</pre></div>
</div>
<p>Conda’yı güncelleyin. Bundan sonraki komutlarda <code class="docutils literal notranslate"><span class="pre">[USERNAME]</span></code> yertutucusunu kendi kullanıcı adınızla değiştirin.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">eval</span> <span class="s2">&quot;</span><span class="k">$(</span>/truba/home/<span class="o">[</span>USERNAME<span class="o">]</span>/miniconda3/bin/conda shell.bash hook<span class="k">)</span><span class="s2">&quot;</span>
conda update conda
</pre></div>
</div>
<p>Conda kullanarak sanal ortam yaratın (tf-gpu) ve yarattığınız ortamı aktifleştirin.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda create --name tf-gpu
conda activate tf-gpu
conda list
</pre></div>
</div>
<p>Çalışmanız için gerekli paketleri kurun.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install <span class="nv">python</span><span class="o">=</span><span class="m">3</span>.8
conda install -c anaconda <span class="nv">cudatoolkit</span><span class="o">=</span><span class="m">10</span>.1
conda install -c anaconda <span class="nv">cudnn</span><span class="o">=</span><span class="m">7</span>.6
pip install tensorflow-gpu<span class="o">==</span><span class="m">2</span>.3
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Not</p>
<p>Python, Tensorflow, CUDA ve cuDNN versiyonlarını <a class="reference external" href="https://www.tensorflow.org/install/source#gpu">öğrenin</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Not</p>
<p>İstediğiniz zaman sanal ortamı kaldırıp baştan başlayabilirsiniz:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda deactivate
conda remove -n tf-gpu --all
conda create --name tf-gpu
conda activate tf-gpu
</pre></div>
</div>
</div>
</div>
<div class="section" id="sbatch-kullanarak-kuyruga-is-gonderin">
<h2>sbatch kullanarak kuyruğa iş gönderin<a class="headerlink" href="#sbatch-kullanarak-kuyruga-is-gonderin" title="Bu başlık için kalıcı bağlantı">¶</a></h2>
<p>Örnek kod hazırlayın: <strong>print_gpu.py</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Kuyruğa iş göndermek için bir <a class="reference external" href="https://slurm.schedmd.com/sbatch.html">slurm betiği</a> hazırlayın: <strong>tensorflow-env.sh</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH -p akya-ai        # Kuyruk adi: Uzerinde GPU olan kuyruk olmasina dikkat edin.</span>
<span class="c1">#SBATCH -A [USERNAME]     # Kullanici adi</span>
<span class="c1">#SBATCH -J print_gpu      # Gonderilen isin ismi</span>
<span class="c1">#SBATCH -o print_gpu.out  # Ciktinin yazilacagi dosya adi</span>
<span class="c1">#SBATCH --gres=gpu:1      # Kac GPU istiyorsunuz? Maksimum sayiyi kontrol edin.</span>
<span class="c1">#SBATCH -N 1              # Gorev kac node&#39;da calisacak?</span>
<span class="c1">#SBATCH -n 1              # Ayni gorevden kac adet calistirilacak?</span>
<span class="c1">#SBATCH -c 8              # Her bir gorev kac cekirdek kullanacak?</span>
<span class="c1">#SBATCH --time=1:00:00    # Sure siniri koyun.</span>

<span class="nb">eval</span> <span class="s2">&quot;</span><span class="k">$(</span>/truba/home/<span class="o">[</span>USERNAME<span class="o">]</span>/miniconda3/bin/conda shell.bash hook<span class="k">)</span><span class="s2">&quot;</span>
conda activate tf-gpu
python print_gpu.py
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Not</p>
<p>Betikteki <code class="docutils literal notranslate"><span class="pre">[USERNAME]</span></code> yertutucusunu kullanıcı adınızla değiştirmeyi unutmayın.</p>
</div>
<p>İşi kuyruğa gönderin.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch tensorflow-env.sh
</pre></div>
</div>
<p>Gönderdiğiniz işin durumunu kontrol edin.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>squeue
</pre></div>
</div>
<p>İş bittikten sonra terminal çıktısını görüntüleyin.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat print_gpu.out
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="container.html" class="btn btn-neutral float-right" title="Container imajları ile çalışın" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Derin öğrenme modelleri gelişitirin" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Telif hakkı 2021, TUBITAK ULAKBIM.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>